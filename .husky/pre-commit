pnpm exec lint-staged

# Validate Vitest config consistency if configs changed
if git diff --cached --name-only | grep -E "vitest\.(config|mutation|base)\.ts"; then
  echo "🔍 Vitest config changes detected, validating consistency..."
  node scripts/validate-vitest-configs.js
fi

# Verify lockfile sync when package.json changes
if git diff --cached --name-only | grep -E "package\.json$" > /dev/null; then
  echo "📦 package.json changed, checking lockfile sync..."
  
  # Verify lockfile is in sync (fail if not)
  pnpm install --frozen-lockfile --dry-run || {
    echo "❌ Lockfile out of sync with package.json"
    echo "   Run: pnpm install"
    echo "   Then stage both package.json and pnpm-lock.yaml"
    exit 1
  }
  
  echo "✅ Lockfile is in sync"
fi

